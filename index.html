<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta charset="UTF-8">
  <link rel="stylesheet" href="./css/main.css" />
  <title>一中南街1号回忆录</title>
  <link rel="shortcut icon" href="./img/logo.jpg" type="image/x-icon">
</head>

<body>
  <div id="app">加载中，请稍候</div>
  <script>
    window.$docsify = {
      el: '#app',
      coverpage: true, //cover页面是否开启
      loadSidebar: true, // 自定义侧栏
      name: '一中南街1号回忆录', //侧栏显示的名字
      sidebarDisplayLevel: 0, //侧栏是否展开 0为不开 1为开
      pagination: { //底部跳转目录
        previousText: '上一部分',
        nextText: '下一部分',
        crossChapter: true, //显示下一篇题目
        crossChapterText: false, //显示下一篇具体内容
      },
      plugins: [ //页脚
        function (hook) {
          var footer = [
            '<hr/>',
            '<div id="twikoocomment">讨论区</div>',
            '<div id="tcomment" style="width:400px"></div>',
            '<hr/>',
            '<footer>',
            '<span>本站由<a href="https://www.springing.top">Spring</a>强力驱动</span>',
            '<br>',
            '<span>往事总在回忆时被赋予意义 —— 2024年新高考一卷</span>',
            '</footer>'
          ].join('');

          hook.afterEach(function (html) {
            return html + footer;
          });

          function getCustomPath() {
  // 获取当前页面的URL
  const url = window.location.href;

  // 找到URL中井号（#）的位置
  const hashIndex = url.indexOf('#');

  // 如果存在井号，并且井号不是URL的最后一个字符
  if (hashIndex !== -1 && url.length > hashIndex + 1) {
    // 构建新的路径，从井号开始，去掉井号后面的部分
    return url.substring(0, hashIndex + 1);
  } else {
    // 如果没有井号或者井号是最后一个字符，返回整个URL
    return url;
  }
}

          // 初始化 Twikoo
          function initTwikoo() {
            console.log('初始化 Twikoo 评论区');
            twikoo.init({
              envId: 'https://twikoo.happyking.top',
              el: '#tcomment',
              path: 'getCustomPath(),',
            });
          }
          // 页面加载时初始化评论区
          hook.ready(initTwikoo);
          // 页面切换时重新渲染评论区
          hook.afterEach(function (html) {
            setTimeout(() => {
              const commentElement = document.getElementById('tcomment');
              if (commentElement) {
                commentElement.innerHTML = ''; // 清空评论区
                initTwikoo(); // 重新初始化 Twikoo
              }
            }, 0); // 0 毫秒延迟
          });
        }
      ],
    };
    
  </script>
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script> <!--主要js引入-->
  <script src="//cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/docsify-sidebar-collapse.min.js"></script>
  <script src="//unpkg.com/docsify-pagination/dist/docsify-pagination.min.js"></script> <!--底部章节跳转-->
  <script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.39/dist/twikoo.all.min.js"></script>

  
</body>
</html>